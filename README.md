# RAG-система

Данный проект представляет собой RAG-систему для автоматического извлечения данных из PDF-файлов годовых отчётов. Система использует:

- **LangChain** для организации цепочек и работы с векторным поиском;  
- **FAISS** для хранения и поиска векторов документов;  
- **SentenceTransformers** для эмбеддингов;  
- **ChatGoogleGenerativeAI** для генерации ответов на вопросы;  
- **PyMuPDF** для чтения PDF.

Скрипт `main.py` автоматически:

1. Загружает PDF-файлы из папки `data/`. Используется PyMuPDFLoader для парсинга текста с сохранением метаданных о страницах.
2. Разбивает текст на куски (chunks) по 1000 символов. Эмбеддинги генерируются моделью all-MiniLM-L6-v2.
3. Строит векторный индекс и сохраняет локально в папку faiss_index или загружает уже созданный при повторных запусках.
4. Обрабатывает вопросы из `questions.json`. Модель Gemini 2.5 Flash анализирует контекст, в промпт заложены инструкции по обработке единиц измерения (thousands/millions) и нормализации числовых значений.
5. Сохраняет прогресс в JSON-файл, включая тексты вопросов и ссылки на первоисточники (SHA1 файла и индекс страницы).

## Установка

1. Склонируйте репозиторий и установите зависимости:

```bash
git clone https://github.com/GusevaVarvara/RAG.git

pip install -r requirements.txt

2. Для работы системы необходим ключ Google Gemini API. Перейдите в Google AI Studio: https://aistudio.google.com/. Нажмите "Get API key" и создайте новый ключ.

Используется модель gemini-2.5-flash, у которой присутствуют лимиты на запросы, что учитывается в коде. Файл с ответами создается постепенно, по мере обновления ежедневного лимита.

3. Поместите исходные PDF-файлы в папку data в корне проекта. Файл с вопросами questions.json должен также находиться в корневой папке.

4. Перед запуском установите переменную окружения с вашим ключом:

Для Windows (PowerShell):

$env:GOOGLE_API_KEY="ВАШ_КЛЮЧ"
python main.py

Для Linux/macOS:

export GOOGLE_API_KEY="ВАШ_КЛЮЧ"
python main.py

Скрипт автоматически формирует submission. Если индекс FAISS уже создан (faiss_index), он будет загружен, иначе создастся новый.
